2:I[4707,[],""]
3:I[6423,[],""]
4:I[4888,["972","static/chunks/972-2edfdfc833581105.js","185","static/chunks/app/layout-f3b52d8364ca85ec.js"],"GoogleAnalytics"]
5:I[5268,["972","static/chunks/972-2edfdfc833581105.js","185","static/chunks/app/layout-f3b52d8364ca85ec.js"],"Providers"]
6:I[5582,["972","static/chunks/972-2edfdfc833581105.js","185","static/chunks/app/layout-f3b52d8364ca85ec.js"],"Layout"]
7:I[5878,["878","static/chunks/878-65f6c5ceb409fdbc.js","471","static/chunks/app/writeups/ssh-into-a-target-server-via-a-bastion-host-without-storing-the-pem-key/page-e6655d4d47c7f279.js"],"Image"]
8:I[2972,["878","static/chunks/878-65f6c5ceb409fdbc.js","972","static/chunks/972-2edfdfc833581105.js","160","static/chunks/app/not-found-260bcb2660817f5a.js"],""]
0:["dGPg5eoynel5a3pjHZN0E",[[["",{"children":["writeups",{"children":["ssh-into-a-target-server-via-a-bastion-host-without-storing-the-pem-key",{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",{"children":["writeups",{"children":["ssh-into-a-target-server-via-a-bastion-host-without-storing-the-pem-key",{"children":["__PAGE__",{},[["$L1",["$","div",null,{"className":"sm:px-8 mx-2 mt-16 sm:mx-6","children":["$","div",null,{"className":"mx-auto w-full max-w-7xl lg:px-8","children":["$","div",null,{"className":"relative px-4 sm:px-8 lg:px-12","children":["$","div",null,{"className":"mx-auto max-w-2xl lg:max-w-5xl","children":["$","div",null,{"className":"xl:relative","children":["$","div",null,{"className":"mx-auto max-w-2xl","children":["$","writeup",null,{"children":[["$","header",null,{"className":"flex flex-col","children":[["$","h1",null,{"className":"mt-6 text-3xl font-bold tracking-tight text-zinc-800 md:text-5xl dark:text-zinc-100","children":"Secure SSH Access Through a Bastion Host Without Storing the Private Key"}],["$","time",null,{"dateTime":"2024-10-07","className":"order-first flex items-center text-sm text-zinc-400 md:text-base dark:text-zinc-500","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","fill":"none","viewBox":"0 0 24 24","strokeWidth":1.5,"stroke":"currentColor","className":"mr-1 h-4 w-4","children":["$","path",null,{"d":"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"}]}],["$","span",null,{"className":"ml-1","children":"October 7, 2024"}],["$","span",null,{"className":"ml-1","children":["• by ",["$","a",null,{"href":"/","className":"hover:text-sky-500 hover:underline","children":"Irfanadziri"}]]}]]}]]}],["$","div",null,{"className":"mt-8 prose dark:prose-invert","data-mdx-content":true,"children":[["$","p",null,{"children":["It's common to use a ",["$","strong",null,{"children":"bastion host"}]," (or jump host) to SSH into private internal servers when working with secure infra environment. Some users may copy their private SSH key (",["$","code",null,{"children":".pem"}]," file) to the bastion host using ",["$","code",null,{"children":"scp -i"}]," for convenience, such as:"]}],"\n",["$","pre",null,{"className":"language-bash","children":["$","code",null,{"className":"language-bash","children":[["$","span",null,{"className":"token function","children":"scp"}]," -i /path/to/private-key.pem /path/to/private-key.pem user@host-public-ip:~/\n"]}]}],"\n",["$","p",null,{"children":["However, storing the key on the bastion host is not secure and increases the risk of key exposure to the public, moreover the bastion host is accessible publicly. A more secure approach is to use ",["$","strong",null,{"children":"SSH agent forwarding"}],", which allow users to forward the private key from local machine >> bastion >> target server, without ever storing the key on the bastion host."]}],"\n",["$","p",null,{"children":["Here’s a simple step-by-step guide, securely forwarding ",["$","code",null,{"children":".pem"}]," key:"]}],"\n",["$","h2",null,{"children":"Step 1: Load the Private Key on Local Machine"}],"\n",["$","ol",null,{"children":["\n",["$","li",null,{"children":["\n",["$","p",null,{"children":"Open terminal on local machine."}],"\n"]}],"\n",["$","li",null,{"children":["\n",["$","p",null,{"children":"Add the private key to the SSH agent:"}],"\n",["$","pre",null,{"className":"language-bash","children":["$","code",null,{"className":"language-bash","children":"ssh-add /path/to/private-key.pem\n"}]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["Replace ",["$","code",null,{"children":"/path/to/private-key.pem"}]," with the correct file and path of private key."]}],"\n"]}],"\n"]}],"\n"]}],"\n",["$","p",null,{"children":"This ensures the key is available for authentication in the next steps."}],"\n",["$","h2",null,{"children":"Step 2: SSH into the Bastion Host with Agent Forwarding"}],"\n",["$","ol",null,{"children":["\n",["$","li",null,{"children":["\n",["$","p",null,{"children":"Run this from local machine:"}],"\n",["$","pre",null,{"className":"language-bash","children":["$","code",null,{"className":"language-bash","children":[["$","span",null,{"className":"token function","children":"ssh"}]," -i /path/to/private-key.pem -A user@bastion-host-public-ip\n"]}]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["Replace ",["$","code",null,{"children":"/path/to/private-key.pem"}]," with the correct file and path of private key."]}],"\n",["$","li",null,{"children":["Replace ",["$","code",null,{"children":"user"}]," with the correct username for the bastion host."]}],"\n",["$","li",null,{"children":["Replace ",["$","code",null,{"children":"bastion-host-public-ip"}]," with the actual public IP of the bastion host."]}],"\n"]}],"\n"]}],"\n"]}],"\n",["$","p",null,{"children":["By using the ",["$","code",null,{"children":"-A"}]," flag, the SSH agent is now forwarded to the bastion host, but the private key remains securely on local machine."]}],"\n",["$","h2",null,{"children":"Step 3: SSH into the Target Server from the Bastion Host"}],"\n",["$","ol",null,{"children":["\n",["$","li",null,{"children":["\n",["$","p",null,{"children":"From the bastion host, run the command:"}],"\n",["$","pre",null,{"className":"language-bash","children":["$","code",null,{"className":"language-bash","children":[["$","span",null,{"className":"token function","children":"ssh"}]," user@target-server-private-ip\n"]}]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["Replace ",["$","code",null,{"children":"user"}]," with the correct username for the target server."]}],"\n",["$","li",null,{"children":["Replace ",["$","code",null,{"children":"target-server-private-ip"}]," with the actual private IP of the target server."]}],"\n"]}],"\n"]}],"\n"]}],"\n",["$","p",null,{"children":["Since the SSH agent is forwarded, the bastion will use the local key for authentication with the target server, without needing the ",["$","code",null,{"children":".pem"}]," file on the bastion host."]}]]}]]}]}]}]}]}]}]}],null],null],null]},[null,["$","$L2",null,{"parallelRouterKey":"children","segmentPath":["children","writeups","children","ssh-into-a-target-server-via-a-bastion-host-without-storing-the-pem-key","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]],null]},[null,["$","$L2",null,{"parallelRouterKey":"children","segmentPath":["children","writeups","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]],null]},[[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/7fab52957256325a.css","precedence":"next","crossOrigin":"$undefined"}]],["$","html",null,{"lang":"en","className":"h-full antialiased","suppressHydrationWarning":true,"children":[["$","$L4",null,{"gaId":"G-V5N6BFQPX5"}],["$","body",null,{"className":"flex h-full bg-sky-100/50 dark:bg-zinc-900","children":["$","$L5",null,{"children":["$","div",null,{"className":"flex w-full","children":["$","$L6",null,{"children":["$","$L2",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","div",null,{"className":"sm:px-8 flex h-full items-center pt-16 sm:pt-32","children":["$","div",null,{"className":"mx-auto w-full max-w-7xl lg:px-8","children":["$","div",null,{"className":"relative px-4 sm:px-8 lg:px-12","children":["$","div",null,{"className":"mx-auto max-w-2xl lg:max-w-5xl","children":["$","div",null,{"className":"flex flex-col items-center","children":[["$","$L7",null,{"src":{"src":"/_next/static/media/404.bf539840.png","height":2000,"width":2000,"blurDataURL":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAY1BMVEVMaXGCckXy8u/y8PEgNUtXXlhaXEwjS274+fkrK0x8iY+tr6r19vVNUkqcdSzcvIX89/fjwIO7x9Dz///x//+3fhPx2rLk4NnP09SlsLe/vLD////v7+/70Yr//vn3w3DPpWKEtAD3AAAAHXRSTlMA/DCRKPXcHbQK/f79vGJ2ad+pXDf2/vr+RPiWUBIQKyQAAAAJcEhZcwAACxMAAAsTAQCanBgAAABBSURBVHicJcbFEYAwAADBixHFXRLov0pmYF8L4DU/a2r7xVeistC03RCMRvZ3LjHuuDyL9Sgn4/KELaULJuWckrxH/QKpQy6d8QAAAABJRU5ErkJggg==","blurWidth":8,"blurHeight":8},"alt":"","className":"w-60 md:w-80"}],["$","h1",null,{"className":"mt-4 text-4xl font-bold tracking-tight text-zinc-800 sm:text-5xl dark:text-zinc-100","children":"404: Page not found"}],["$","p",null,{"className":"mt-4 text-sm text-zinc-600 sm:text-base dark:text-zinc-400","children":"Crawl what, dude? Nothing to see here HAHA."}],["$","$L8",null,{"className":"inline-flex items-center gap-2 justify-center rounded-md py-2 px-3 text-sm outline-offset-2 transition active:transition-none bg-zinc-50 font-medium text-zinc-900 hover:bg-zinc-100 active:bg-zinc-100 active:text-zinc-900/60 dark:bg-zinc-800/50 dark:text-zinc-300 dark:hover:bg-zinc-800 dark:hover:text-zinc-50 dark:active:bg-zinc-800/50 dark:active:text-zinc-50/70 mt-4","href":"/","children":"Go back home, now!"}]]}]}]}]}]}],"notFoundStyles":[]}]}]}]}]}]]}]],null],null],["$L9",null]]]]
9:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"Secure SSH Access Through a Bastion Host Without Storing the Private Key"}],["$","meta","3",{"name":"description","content":"Learn how to securely SSH into a private target server through a bastion host by forwarding private key using SSH agent forwarding, avoiding key exposure on the bastion host."}]]
1:null
